{"ast":null,"code":"import \"core-js/modules/es.function.name.js\";\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, vModelSelect as _vModelSelect, withDirectives as _withDirectives, vModelText as _vModelText, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, withModifiers as _withModifiers } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"crypto-purchase\"\n};\nvar _hoisted_2 = {\n  \"class\": \"form-container\"\n};\nvar _hoisted_3 = {\n  \"class\": \"form-group\"\n};\nvar _hoisted_4 = [\"value\"];\nvar _hoisted_5 = {\n  \"class\": \"form-group\"\n};\nvar _hoisted_6 = {\n  \"class\": \"form-group\"\n};\nvar _hoisted_7 = [\"value\"];\nvar _hoisted_8 = {\n  \"class\": \"form-group\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[12] || (_cache[12] = _createElementVNode(\"h1\", null, \"Comprar criptomonedas\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"form\", {\n    onSubmit: _cache[4] || (_cache[4] = _withModifiers(function () {\n      return $options.submitPurchase && $options.submitPurchase.apply($options, arguments);\n    }, [\"prevent\"]))\n  }, [_createElementVNode(\"div\", _hoisted_3, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", {\n    \"for\": \"cryptoSelect\"\n  }, \"Seleccionar criptomoneda\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"select\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n      return $data.selectedCrypto = $event;\n    }),\n    id: \"cryptoSelect\",\n    required: \"\"\n  }, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.cryptos, function (crypto) {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: crypto.code,\n      value: crypto.code\n    }, _toDisplayString(crypto.name), 9 /* TEXT, PROPS */, _hoisted_4);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), [[_vModelSelect, $data.selectedCrypto]])]), _createElementVNode(\"div\", _hoisted_5, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n    \"for\": \"cryptoAmount\"\n  }, \"Cantidad\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"number\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n      return $data.cryptoAmount = $event;\n    }),\n    id: \"cryptoAmount\",\n    required: \"\",\n    min: \"0.01\",\n    step: \"any\",\n    onInput: _cache[2] || (_cache[2] = function () {\n      return _ctx.calculateTotalPrice && _ctx.calculateTotalPrice.apply(_ctx, arguments);\n    })\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, $data.cryptoAmount]])]), _createElementVNode(\"div\", _hoisted_6, [_cache[7] || (_cache[7] = _createElementVNode(\"label\", {\n    \"for\": \"cryptoSpent\"\n  }, \"Monto a pagar (ARS)\", -1 /* HOISTED */)), _createElementVNode(\"input\", {\n    type: \"number\",\n    value: $options.totalPrice,\n    id: \"cryptoSpent\",\n    required: \"\",\n    min: \"0.01\",\n    step: \"any\",\n    readonly: \"\"\n  }, null, 8 /* PROPS */, _hoisted_7)]), _createElementVNode(\"div\", _hoisted_8, [_cache[8] || (_cache[8] = _createElementVNode(\"label\", {\n    \"for\": \"datetime\"\n  }, \"Fecha y hora\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"datetime-local\",\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = function ($event) {\n      return $data.purchaseDateTime = $event;\n    }),\n    id: \"datetime\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.purchaseDateTime]])]), _createVNode(_component_router_link, {\n    to: \"/home\",\n    \"class\": \"btn\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[9] || (_cache[9] = [_createTextVNode(\"Volver\")]);\n    }),\n    _: 1 /* STABLE */\n  }), _cache[11] || (_cache[11] = _createElementVNode(\"button\", {\n    type: \"submit\"\n  }, \"Comprar\", -1 /* HOISTED */)), _createVNode(_component_router_link, {\n    to: \"/history\",\n    \"class\": \"btn\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[10] || (_cache[10] = [_createTextVNode(\"Ver historial\")]);\n    }),\n    _: 1 /* STABLE */\n  })], 32 /* NEED_HYDRATION */)])]);\n}","map":{"version":3,"names":["_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","onSubmit","_cache","_withModifiers","$options","submitPurchase","apply","arguments","_hoisted_3","$event","$data","selectedCrypto","id","required","_Fragment","_renderList","cryptos","crypto","key","code","value","name","_hoisted_4","_hoisted_5","type","cryptoAmount","min","step","onInput","_ctx","calculateTotalPrice","_hoisted_6","totalPrice","readonly","_hoisted_7","_hoisted_8","purchaseDateTime","_createVNode","_component_router_link","to","_withCtx","_createTextVNode","_"],"sources":["C:\\Users\\Usuario\\Documents\\tp_final\\src\\views\\CryptoPurchase.vue"],"sourcesContent":["<template>\n    <div class=\"crypto-purchase\">\n        <h1>Comprar criptomonedas</h1>\n        <div class=\"form-container\">\n        <form @submit.prevent=\"submitPurchase\">\n            <div class=\"form-group\">\n                <label for=\"cryptoSelect\">Seleccionar criptomoneda</label>\n                <select v-model=\"selectedCrypto\" id=\"cryptoSelect\" required>\n                <option v-for=\"crypto in cryptos\" :key=\"crypto.code\" :value=\"crypto.code\">\n                {{ crypto.name }}\n                </option>\n            </select>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"cryptoAmount\">Cantidad</label>\n                <input type=\"number\" v-model=\"cryptoAmount\" id=\"cryptoAmount\" required min=\"0.01\" step=\"any\" @input=\"calculateTotalPrice\" />\n            </div>\n            <div class=\"form-group\">\n                <label for=\"cryptoSpent\">Monto a pagar (ARS)</label>\n                <input type=\"number\" :value=\"totalPrice\" id=\"cryptoSpent\" required min=\"0.01\" step=\"any\" readonly />\n            </div>\n            <div class=\"form-group\">\n                <label for=\"datetime\">Fecha y hora</label>\n                <input type=\"datetime-local\" v-model=\"purchaseDateTime\" id=\"datetime\" />\n            </div>\n            <router-link to=\"/home\" class=\"btn\">Volver</router-link>\n            <button type=\"submit\">Comprar</button>\n            <router-link to=\"/history\" class=\"btn\">Ver historial</router-link>\n        </form>\n        </div>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios'\n\nexport default {\n  data () {\n    return {\n      cryptos: [\n        { code: 'eth', name: 'Ethereum' },\n        { code: 'usdt', name: 'Tether' },\n        { code: 'usdc', name: 'USD Coin' },\n        { code: 'sol', name: 'Solana' }\n      ],\n      selectedCrypto: '',\n      cryptoAmount: 0,\n      purchaseDateTime: '',\n      cryptoPrice: 0\n    }\n  },\n\n  watch: {\n    selectedCrypto (newCrypto) {\n      if (newCrypto) {\n        this.fetchCryptoPrices(newCrypto)\n      }\n    },\n    cryptoAmount (newAmount) {\n    }\n  },\n\n  methods: {\n    async fetchCryptoPrices (crypto) {\n      try {\n        const response = await axios.get(`https://criptoya.com/api/letsbit/${crypto.toUpperCase()}/ARS/0.1`)\n        this.cryptoPrice = response.data.totalBid || 0\n      } catch (error) {\n        console.error('Error al obtener los precios:', error)\n      }\n    },\n\n    async submitPurchase () {\n      const amount = parseFloat(this.cryptoAmount)\n      if (!this.selectedCrypto) {\n        alert('Debes seleccionar una criptomoneda')\n        return\n      }\n      if (!this.amount <= 0) {\n        alert('Debes ingresar una cantidad mayor a 0')\n        return\n      }\n      if (!this.purchaseDateTime) {\n        alert('Debes ingresar una fecha y hora validas')\n        return\n      }\n      const userId = localStorage.getItem('userId')\n      if (!userId) {\n        alert('No se encontro el ID del usuario')\n        return\n      }\n      const purchaseData = {\n        user_id: userId,\n        action: 'purchase',\n        crypto_code: this.selectedCrypto,\n        crypto_amount: amount,\n        money: this.totalPrice,\n        datetime: this.purchaseDateTime\n      }\n      const headers = {\n        'x-apikey': '60eb09146661365596af552f',\n        'Content-Type': 'application/json'\n      }\n\n      try {\n        const response = await axios.post('https://laboratorio3-f36a.restdb.io/rest/transactions', purchaseData, { headers })\n        alert('Compra exitosa', response.data)\n        console.log('Compra exitosa', response.data)\n      } catch (error) {\n        console.error('error al comprar:', error)\n        alert('Error')\n      }\n    }\n  },\n\n  mounted () {\n    if (this.selectedCrypto) {\n      this.fetchCryptoPrices(this.selectedCrypto)\n    }\n  },\n\n  computed: {\n    totalPrice () {\n      return (this.cryptoAmount * this.cryptoPrice).toFixed(2)\n    }\n  }\n}\n</script>\n\n<style scoped>\n  .crypto-purchase{\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 20px;\n  }\n\n  .form-container{\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n  }\n\n  h1{\n    color: #333;\n    font-size: 30px;\n    margin-bottom: 50px;\n  }\n\n  input, select{\n    width: 100%;\n    padding: 10px;\n    border: 1px solid #333;\n    border-radius: 5px;\n    font-size: 18px;\n    margin-right: 10px;\n  }\n\n  .form-group{\n    margin-bottom: 20px;\n  }\n\n  button{\n    background-color: #007bff;\n    color: white;\n    border: none;\n    border-radius: 5px;\n    padding: 10px 20px;\n    transition: background-color 0.5s;\n    font-size: 16px;\n  }\n  .btn{\n    display: inline-block;\n    margin-top: 20px;\n    padding: 10px 20px;\n    background-color: #007bff;\n    color: white;\n    text-decoration: none;\n    border-radius: 5px;\n    margin-right:5px;\n  }\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}